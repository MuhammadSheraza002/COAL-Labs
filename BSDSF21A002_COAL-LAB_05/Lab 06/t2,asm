.model small 
.stack 100h
.386
.code
main proc
               mov ax,@data
               mov ds,ax
               mov dx,offset Enter_Message
               mov ah,09
               int 21h
               mov cx,0
               call get_input
               call decrement_cx
               mov dx,offset Output_Message
               call Message_print
               call Output_manage
               call input_hexa
               mov ah,4ch
               int 21h
               main endp


    input_hexa proc:
               mov ah,01
               int 21h
               call valid_input_hexa
               cmp al,0dh
               je end_
               sub al,30h
               or  bl,al
               cmp cx,15
               je end_
               shl bx,1
               inc cx
               jne get_input
               end_:
                inc cx
                ret
                get_input endp


    valid_input_hexa PROC
        cmp al,'1'
        je ret
        cmp al,'0'
        je ret
        jmp try_again_hexa
        ret 
        valid_input endp

    try_again_hexa proc
    mov dx,offset wong_input
    call Message_print
    jmp main
    valid_input_hexa ENDP




    Message_print proc
    mov ah,09
    int 21H
    ret
    Message_print endp


    decrement_cx proc
    cmp cx,4
    jl stop
    dec cx
    stop:
    ret
    decrement_cx endp
    get_input proc
               mov ah,01
               int 21h
               call valid_input
               cmp al,0dh
               je end_
               sub al,30h
               or  bl,al
               cmp cx,3
               je end_
               shl bx,4
               inc cx
               jne get_input
               end_:
                inc cx
                ret
                get_input endp
            
    


    valid_input proc
        cmp al,61h
        je try_again
        cmp al,7Ah
        je try_again
        ret 
        valid_input endp

    try_again proc
    mov dx,offset wong_input
    call Message_print
    jmp main


    Output_manage proc
               call Output
               ret
               Output_manage endp 
    

    Output proc     
               shl bx,1
               jc  One
               mov dl,30h
               mov ah,02
               int 21h
               dec ch
               jnz Output
               ret 
               Output endp

    One proc       
               mov dl,31h
               mov ah,02
               int 21h
               dec ch
               jnz Output
               ret
               One endp




.data
    wong_input db 10,13,"Illegal iNPUT try Again: $"
    Enter_Message  db 10,13,"Enter No in HexaDecimal 0 to FFFF: $"
    Output_Message db 10,13,"Output in Binary is: $"


end main